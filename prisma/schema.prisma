// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  output   = "../src/__generated__/prisma"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id                    String   @id @default(cuid())
  theKeySsoGuid         String   @unique
  theKeyGuid            String
  theKeyRelayGuid       String
  theKeyGrPersonId      String?
  email                 String
  nameFirst             String
  nameLast              String
  homeCountry           String?
  notificationCountries String   @default("[]") // JSON array as string
  createdAt             DateTime
  updatedAt             DateTime
  cas                   BigInt
  
  // Sync data
  syncRev               String
  syncSequence          Int
  syncRecentSequences   String   @default("[]") // JSON array as string
  syncTimeSaved         String
  
  // Metadata
  ingestedAt            DateTime @default(now())
  
  @@map("users")
}

model Playlist {
  id                    String   @id @default(cuid())
  owner                 String
  playlistName          String
  playlistByDisplayName String?
  note                  String   @default("")
  noteModifiedAt        DateTime?
  createdAt             DateTime?
  updatedAt             DateTime?
  cas                   BigInt
  
  // Sync data
  syncRev               String
  syncSequence          Int
  syncRecentSequences   String   @default("[]") // JSON array as string
  syncTimeSaved         String
  
  // Metadata
  ingestedAt            DateTime @default(now())
  
  // Relations
  items                 PlaylistItem[]
  
  @@map("playlists")
}

model PlaylistItem {
  id                String   @id @default(cuid())
  playlistId        String
  createdAt         DateTime
  languageId        Int
  mediaComponentId  String
  type              String?
  
  // Relations
  playlist          Playlist @relation(fields: [playlistId], references: [id], onDelete: Cascade)
  
  @@map("playlist_items")
}
